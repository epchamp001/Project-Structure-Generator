# üèóÔ∏èProject Structure Generator

–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ Go, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º **Go Clean Architecture**, —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:

- gRPC
- HTTP
- Redis
- Prometheus (metrics)
- Grafana (dashboard provisioning)
- K6 (–Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–°–æ–±–µ—Ä–∏—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∏–Ω–∞—Ä–Ω–∏–∫ –≤ `$GOPATH/bin` (–∏–ª–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏–∑ `$GOBIN`):

```bash
go install github.com/epchamp001/Project-Structure-Generator/cmd/gen@v0.1.0
```

> –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ $(go env GOPATH)/bin (–∏–ª–∏ –≤–∞—à GOBIN) –¥–æ–±–∞–≤–ª–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ä–µ–¥—ã PATH.

### –ó–∞–ø—É—Å–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞

```bash
gen -n <appName> -c <cmdName> [-d <targetDir>] [-g] [-t] [-r] [-f] [-m] [-l]
```

### –ó–∞–ø—É—Å–∫ –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

–ï—Å–ª–∏ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫ –≥–ª–æ–±–∞–ª—å–Ω–æ, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞:

```bash
go run cmd/gen/main.go \
  -n <appName> \
  -c <cmdName> \
  [-d <targetDir>] \
  [-g] [-t] [-r] [-f] [-m] [-l]
```

## üß© –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–ª–∞–≥–∏

| –§–ª–∞–≥              | –ù–∞–∑–≤–∞–Ω–∏–µ                          | –¢–∏–ø    | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –û–ø–∏—Å–∞–Ω–∏–µ                                              |
|-------------------|-----------------------------------|--------|--------------|-------------------------------------------------------|
| `-n`, `--name`    | –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞                  | string | ‚úÖ            | –ù–∞–∑–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞                           |
| `-c`, `--cmd`     | –ù–∞–∑–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ `cmd/`      | string | ‚úÖ            | –ò–º—è –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ `cmd/`                            |
| `-d`, `--dir`     | –¶–µ–ª–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è                | string | ‚ùå            | –ü—É—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞                               |
| `-g`, `--grpc`    | –í–∫–ª—é—á–∏—Ç—å gRPC                     | bool   | ‚ùå            | –í–∫–ª—é—á–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é gRPC —Å–ª–æ—ë–≤                         |
| `-t`, `--http`    | –í–∫–ª—é—á–∏—Ç—å HTTP                     | bool   | ‚ùå            | –í–∫–ª—é—á–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é HTTP —Å–ª–æ—ë–≤                         |
| `-r`, `--redis`   | –í–∫–ª—é—á–∏—Ç—å Redis                    | bool   | ‚ùå            | –î–æ–±–∞–≤–ª—è–µ—Ç Redis-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π                           |
| `-f`, `--grafana` | –í–∫–ª—é—á–∏—Ç—å Grafana                  | bool   | ‚ùå            | –î–æ–±–∞–≤–ª—è–µ—Ç Grafana dashboards                          |
| `-m`, `--metrics` | –í–∫–ª—é—á–∏—Ç—å Prometheus               | bool   | ‚ùå            | –î–æ–±–∞–≤–ª—è–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ —Ñ–∞–π–ª—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Prometheus |
| `-l`, `--load`    | –í–∫–ª—é—á–∏—Ç—å –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | bool   | ‚ùå            | –î–æ–±–∞–≤–ª—è–µ—Ç `scripts/k6/load_test.js`                   |

> ‚ùó –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é gRPC –∏ HTTP –≤–∫–ª—é—á–µ–Ω—ã, –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω –Ω–∏ –æ–¥–∏–Ω –∏–∑ —ç—Ç–∏—Ö –¥–≤—É—Ö —Ñ–ª–∞–≥–æ–≤. –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ—Ç–∫–ª—é—á–µ–Ω—ã.

## üîß –ü–µ—Ä–≤–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:

```bash
go mod tidy
```

–ù–∞—Å—Ç—Ä–æ–π –≤—Ä—É—á–Ω—É—é –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ–∞–π–ª—ã.

P.S. –ü–æ–∑–∂–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏ –ø–æ–º–æ—â–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–ª–∞–≥–æ–≤.

### ‚öôÔ∏è –ß—Ç–æ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å

1. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Redis –¥–æ–±–∞–≤—å:

```go
viper.BindEnv("storage.redis.host", "REDIS_HOST")
```

2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –õ–æ–≥–≥–µ—Ä–∞:

–í—Å—ë –ø—Ä–æ–ø–∏—Å–∞–Ω–æ –≤ pkg/logger. –ï—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω sampling –∏ initial fields, —Ç–æ –≤ config.yaml —Å–¥–µ–ª–∞–π —Ç–∞–∫:

```yaml
sampling: null
initialFields: {}
```

3. –û–±–Ω–æ–≤–∏ shutdown –≤ main.go. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Shutdown –∏–∑ –Ω—É–∂–Ω–æ–π —Ç–µ–±–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

```go
shutdownCtx, cancel := context.WithTimeout(context.Background(), time.Duration(cfg.PublicServer.ShutdownTimeout)*time.Second)
```

4. –ü—Ä–æ–≤–µ—Ä—å –∏ –ø–æ–ø—Ä–∞–≤—å:
* config.yaml
* prometheus.yaml
* Dockerfile
* .env, .env.example
* docker-compose.yaml
* Makefile
* –∏–º–ø–æ—Ä—Ç—ã –≤–æ –≤—Å–µ—Ö .go —Ñ–∞–π–ª–∞—Ö

5. –ü—Ä–æ–≤–µ—Ä—å –ø–æ—Ä—Ç—ã –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ grafana, prometheus, docker-compose.yaml

6. –ü—Ä–æ–≤–µ—Ä—å tests/integration. –ù—É–∂–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ë–î.